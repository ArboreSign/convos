(function(e){var f=!!("ontouchstart" in window)?110:40;var b=document.title;var c=b;var h,a,j;var g=function(){var m=e(this);var k="Click again to confirm";var l=m.text();if(l==k){return true}m.text(k).one("mouseleave",function(){m.text(l)});return false};var d=function(){var k=e(this);var l=k.find(":selected").attr("value");location.href=location.href.replace(/\/settings.*/,"/settings/"+l)};var i=function(){var m=e(this);var l=m.attr("data-focus");var n=m.attr("data-toggle");var k=false;e(n).on("click","a",function(){m.trigger("deactivate")});m.click(function(q){if(k){return false}var o=e(n);var p=m.hasClass("active");e("a[data-toggle]").filter(".active").trigger("deactivate");if(p){return false}k=true;m.trigger("activate");if(!m.hasClass("active")){m.addClass("active");o.show();i.visible=o;if(l){e(l).focus()}}k=false;return false});m.on("deactivate",function(){m.removeClass("active");e(n).hide();i.visible=false});m.on("activate",function(){m.removeClass("active");m.click()})};e.notify=function(o,k,l){if(a.data("has_focus")){return this}if(Notification.permission=="granted"){var p=new Notification(o,{iconUrl:l,body:k,onclose:function(){clearTimeout(m)}});var m=setTimeout(function(){p.close()},5000)}c=o;if(e.notify.focus_tid){clearInterval(e.notify.focus_tid)}if(document.title==c||document.title==b){document.title=[b,c].join(" - ")}else{document.title=c}return this};e.fn.focusSoon=function(){var k=this.eq(0);setTimeout(function(){k.focus()},100);return this};e.fn.loadingIndicator=function(l){if(l=="hide"){this.find(".loading-indicator-overlay, .loading-indicator").remove()}else{var k=this.css("position")||"static";if(k=="static"){this.css("position","relative")}this.append('<div class="loading-indicator-overlay"></div><div class="loading-indicator"></div>')}return this};e.fn.scrollTo=function(k){if(k==="bottom"){e(this).scrollTop(h.height());a.data("at_bottom",true)}else{e(this).scrollTop(k);a.data("at_bottom",false)}return this};e.url_for=function(){var k=e.makeArray(arguments);if(!j){j=e('script[src$="jquery.js"], script[src*="_="]').get(0).src.replace(/\/(js\/)?\w+\.js.*/,"").replace(/^\w+:\/\/[^\/]+/,"")}k.unshift(j);return k.join("/").replace(/#/g,"%23")};e(document).ready(function(){var l=e("a[data-toggle]").each(i);var m=l.filter(".active").trigger("activate").filter(".focus");var k=e('a[data-toggle="div.login"]');e(document).click(function(o){var n=i.visible;if(!n){return true}if(n.hasClass("ignore-document-close")){return true}if(e(o.target).closest(n).length){return true}e("a[data-toggle]").filter(".active").trigger("deactivate");return false});e('.settings select[name="cid"]').change(d);e("a.confirm").click(g);if(k.length){e("body").bind("keydown","shift+return",function(n){n.preventDefault();k.click()})}h=e("div.wrapper").length?e("div.wrapper"):e("body");a=e(window).data("at_bottom",false).data("has_focus",true);e(document).data("height_from",h);a.on("scroll",function(){var n=a.scrollTop()+a.height()>h.height()-f;a.data("at_bottom",n)});a.blur(function(){a.data("has_focus",false)});a.focus(function(){if(e.notify.focus_tid){clearInterval(e.notify.focus_tid)}e.notify.focus_tid=setInterval(function(){document.title=b},3000);a.data("has_focus",true)})})})(jQuery);