(function(f){var g=!!("ontouchstart" in window)?110:40;var c=document.title;var d=c;var k=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);var b,i,a,j;var h=function(){var n=f(this);var l="Click again to confirm";var m=n.text();if(m==l){return true}n.text(l).one("mouseleave",function(){n.text(m)});return false};var e=function(){var l=f(this);var m=l.find(":selected").attr("value");location.href=location.href.replace(/\/settings.*/,"/settings/"+m)};f.notify=function(p,l,m){if(a.data("has_focus")){return this}if(Notification.permission=="granted"){var q=new Notification(p,{iconUrl:m,body:l,onclose:function(){clearTimeout(o)}});var o=setTimeout(function(){q.close()},5000)}d=p;if(f.notify.focus_tid){clearInterval(f.notify.focus_tid)}if(document.title==d||document.title==c){document.title=[c,d].join(" - ")}else{document.title=d}return this};f.fn.focusSoon=function(){var l=this.eq(0);setTimeout(function(){l.focus()},100);return this};f.fn.initDropDown=function(){return this.each(function(){var l=f(this);var m=f(l.data("toggle"));if(!k){m.addClass("nanoscroller").wrapInner('<div class="content"/>').nanoScroller({preventPageScrolling:true})}l.on("activate",function(){var o=f(this);var n=a.height()-70;var p=o.offset().left+o.outerWidth()-m.width();if(p<10){p=10}m.css({left:p,height:n}).nanoScroller()})})};f.fn.loadingIndicator=function(m){if(m=="hide"){this.find(".loading-indicator-overlay, .loading-indicator").remove()}else{var l=this.css("position")||"static";if(l=="static"){this.css("position","relative")}this.append('<div class="loading-indicator-overlay"></div><div class="loading-indicator"></div>')}return this};f.fn.scrollTo=function(l){if(l==="bottom"){f(this).scrollTop(i.height());a.data("at_bottom",true)}else{f(this).scrollTop(l);a.data("at_bottom",false)}return this};f.fn.toggleElementWithClick=function(){return this.each(function(){var n=f(this);var m=n.attr("data-focus");var o=n.attr("data-toggle");var l=false;f(o).on("click","a",function(){n.trigger("deactivate")});n.on("deactivate",function(){n.removeClass("active");f(o).hide()});n.on("activate",function(){n.removeClass("active");n.click()});n.click(function(r){if(l){return false}var p=f(o);var q=n.hasClass("active");f("a[data-toggle]").filter(".active").trigger("deactivate");b=false;if(q){return false}if(!n.hasClass("active")){b=n;l=true;p.show();n.data("target",p).trigger("activate").addClass("active");l=false;if(m){f(m,o).eq(0).focusSoon()}}return false})})};f.url_for=function(){var l=f.makeArray(arguments);if(!j){j=f('script[src$="jquery.js"], script[src*="_="]').get(0).src.replace(/\/(minified\/)?\w+\.js.*/,"").replace(/^\w+:\/\/[^\/]+/,"")}l.unshift(j);return l.join("/").replace(/#/g,"%23")};f(document).ready(function(){var m=f("a[data-toggle]").toggleElementWithClick();var n=m.filter(".active").trigger("activate").filter(".focus");var l=f('a[data-toggle="div.login"]');f(document).click(function(o){if(!b){return true}if(b.hasClass("ignore-document-close")){return true}if(f(o.target).closest(b).length){return true}f("a[data-toggle]").filter(".active").trigger("deactivate");return false});f('.settings select[name="cid"]').change(e);f("a.confirm").click(h);if(l.length){f("body").bind("keydown","shift+return",function(o){o.preventDefault();l.click()})}if(k){f.fn.nanoScroller=function(){return this}}i=f("div.wrapper").length?f("div.wrapper"):f("body");a=f(window).data("at_bottom",false).data("has_focus",true);f(document).data("height_from",i);a.on("scroll",function(){var o=a.scrollTop()+a.height()>i.height()-g;a.data("at_bottom",o)});a.blur(function(){a.data("has_focus",false)});a.focus(function(){if(f.notify.focus_tid){clearInterval(f.notify.focus_tid)}f.notify.focus_tid=setInterval(function(){document.title=c},3000);a.data("has_focus",true)})})})(jQuery);