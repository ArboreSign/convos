(function(){Vue.component("convos-create-dialog",{props:["user"],data:function(){return{connectionId:"",dialogName:"",message:"",errors:[],rooms:[]};},watch:{connectionId:function(){this.message="";}},methods:{connection:function(){return this.user.getConnection(this.connectionId);},join:function(option){var room=option.value||this.dialogName;if(room)this.connection().send("/join "+room);this.dialogName="";},load:function(e){var self=this;this.errors=[];this.message="Loading rooms...";this.connection().rooms(function(err,rooms){if(err)return self.errors=err;var s=rooms.length==1?"":"s";self.dialogName="";self.message=rooms.length?"Found "+rooms.length+" room"+s+".":"No rooms found.";self.rooms=rooms.map(function(r){if(!r.topic)r.topic="No topic";return{text:[r.name,r.topic].join(" - "),title:r.topic,value:r.name};});self.materializeComponent();});}},template:"<div class=\"convos-create-dialog\">\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <h4>Join dialog</h4>\n        <p v-if=\"!user.connections.length\">\n          You need to <a href=\"#connections\">create a connection</a> before\n          you can create or join any dialog.\n        </p>\n        <p v-if=\"user.connections.length\">\n          You can create a dialog with either a single user (by nick)\n          or join a chat room (channel). Click &quot;<a @click.prevent=\"load\" href=\"#load\">Load</a>&quot;\n          to get a list of available rooms. Note that loading the list\n          from the server might take a while.\n        </p>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"input-field col s12\">\n        <md-select :value.sync=\"connectionId\" id=\"form_connection_id\">\n          <md-option :selected=\"connectionId == c.id\" :value=\"c.id\" v-for=\"c in user.connections\">{{c.protocol}}-{{c.name}}</md-option>\n        </md-select>\n        <label for=\"form_connection_id\">Select connection</label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"input-field input-btn-right col s12\">\n        <a @click.prevent=\"load\" class=\"btn waves-effect waves-light\" href=\"#load\" v-tooltip=\"message\">Load</a>\n        <div class=\"input-left\">\n          <md-autocomplete :options=\"rooms\" :value.sync=\"dialogName\" @select=\"join\" id=\"form_dialog_name\"></md-autocomplete>\n          <label for=\"form_dialog_name\">Room or nick</label>\n        </div>\n      </div>\n    </div>\n    <div class=\"row\" v-if=\"errors.length\">\n      <div class=\"input-field col s12\"><div class=\"alert\">{{errors[0].message}}</div></div>\n    </div>\n    <div class=\"row\">\n      <div class=\"input-field col s12\">\n        <a class=\"btn waves-effect waves-light\" v-if=\"!user.dialogs.length\" v-link=\"&#39;#connection/&#39; + connectionId\">\n          <i class=\"material-icons left\">navigate_before</i>Back\n        </a>\n        <button :disabled=\"!dialogName.length\" @click=\"join\" class=\"btn waves-effect waves-light\">\n          Chat <i class=\"material-icons right\">send</i>\n        </button>\n      </div>\n    </div>\n  </div>\n"})})();